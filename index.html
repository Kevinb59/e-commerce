<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Accueil - Restaurant</title>
  <link rel="stylesheet" href="styles/style-index.css">
  <script type="module">
    // Importer les modules Firebase et la configuration depuis le fichier sécurisé
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";
    import { firebaseConfig } from './js/firebase-config.js';

    // Initialiser Firebase avec la configuration importée
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Fonction pour récupérer les articles depuis Firebase
    async function fetchArticles() {
      const articlesList = document.getElementById('articles-list');
      try {
        const querySnapshot = await getDocs(collection(db, "articles"));
        querySnapshot.forEach((doc) => {
          const article = doc.data();
          const articleElement = `
            <div class="article">
              <img src="${article.image}" alt="${article.title}" class="article-image" />
              <h3 class="article-title">${article.title}</h3>
              <p class="article-description">${article.description}</p>
              <p class="article-price">${article.price.toFixed(2)} €</p>
              <button class="article-btn">Ajouter au panier</button>
            </div>`;
          articlesList.innerHTML += articleElement;
        });
      } catch (error) {
        console.error("Erreur lors de la récupération des articles :", error);
      }
    }

    // Charger les articles lors de l'ouverture de la page
    window.onload = fetchArticles;
  </script>
</head>
<body>
  <!-- Espaces pour inclure les composants -->
  <div id="header-placeholder"></div>
  <div id="toggle-menu-placeholder"></div>

  <main>
    <!-- Cadre de connexion/inscription -->
    <section class="auth-section">
      <div class="auth-box">
        <h2>Bienvenue !</h2>
        <p>Pour passer une commande, veuillez vous <a href="login.html">connecter</a> ou vous <a href="register.html">inscrire</a>.</p>
      </div>
    </section>

    <!-- Section des articles -->
    <section class="articles-section">
      <h2>Nos articles</h2>
      <div class="articles-list" id="articles-list"></div>
    </section>
  </main>

  <div id="footer-placeholder"></div>

  <!-- Script pour charger les composants -->
  <script>
    // Charger dynamiquement les composants communs
    fetch('components/header.html').then(response => response.text()).then(data => {
      document.getElementById('header-placeholder').innerHTML = data;
    });

    fetch('components/toggle-menu.html').then(response => response.text()).then(data => {
      document.getElementById('toggle-menu-placeholder').innerHTML = data;
    });

    fetch('components/footer.html').then(response => response.text()).then(data => {
      document.getElementById('footer-placeholder').innerHTML = data;
    });
  </script>
</body>
</html>
